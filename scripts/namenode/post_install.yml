- pause: seconds=10 prompt="Wait for namenode to start"


- shell: "docker exec namenode /opt/hadoop/bin/hdfs --config /opt/hadoop/etc/hadoop dfsadmin -safemode wait"
  args:
    executable: "/bin/bash"

- shell: "docker exec namenode /opt/hadoop/bin/hdfs --config /opt/hadoop/etc/hadoop dfs -mkdir -p {{item}}"
  args:
    executable: "/bin/bash"
  with_items:
    - "/tmp"
    - "/user/root"
    - "/user/bb"

- shell: "docker exec namenode /opt/hadoop/bin/hdfs --config /opt/hadoop/etc/hadoop dfs -chown -R {{item.owner}}:{{item.group}} {{item.path}}"
  args:
    executable: "/bin/bash"
  with_items:
    - "{path: '/tmp', owner: 'root', group: 'supergroup'} "
    - "{path: '/user', owner: 'root', group: 'supergroup'} "
    - "{path: '/user/bb', owner: 'bb', group: 'bigboards'} "

- shell: "docker exec namenode /opt/hadoop/bin/hdfs --config /opt/hadoop/etc/hadoop dfs -chmod -R 777 {{item}}"
  args:
    executable: "/bin/bash"
  with_items:
    - "/tmp"
